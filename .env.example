############################
# FES Assistant (.env.example)
# This file is safe to commit. Do NOT put real secrets here.
############################


############################
# LLM PROVIDER CONFIG
############################

# Which provider to use for the FES agent: "azure" or "databricks"
LLM_PROVIDER=azure

# --- Azure OpenAI (if LLM_PROVIDER=azure) ---
AZURE_OPENAI_ENDPOINT=https://your-azure-openai-endpoint.openai.azure.com
AZURE_OPENAI_DEPLOYMENT=gpt-4o
AZURE_OPENAI_API_KEY=
# v1 = new /openai/v1/chat/completions style; "legacy" for older deployment-style URL
AZURE_OPENAI_API_STYLE=v1
# Optional (only if your code uses it)
# AZURE_OPENAI_API_VERSION=2024-11-20

# --- Databricks (if LLM_PROVIDER=databricks) ---
# DATABRICKS_HOST=https://your-workspace.cloud.databricks.com
# DATABRICKS_TOKEN=
# LLM_ENDPOINT=your-serving-endpoint-name


############################
# PYSISENSE DOCS / EXAMPLES
############################

PYSISENSE_EXAMPLES_ROOT=/absolute/path/to/pysisense/examples
PYSISENSE_DOCS_ROOT=/absolute/path/to/pysisense/docs


############################
# MCP HTTP SERVER CONFIG
############################

# Where the PySisense MCP HTTP server (mcp_server/server.py) is running
PYSISENSE_MCP_HTTP_URL=http://localhost:8002

# Timeout (seconds) for MCP HTTP calls.
# Keep this high if you run long migrations via MCP.
PYSISENSE_MCP_HTTP_TIMEOUT=1800

# IMPORTANT: keep retries low for non-idempotent operations (e.g., migrations)
MCP_HTTP_MAX_RETRIES=1
MCP_HTTP_RETRY_BASE_DELAY=0.5

# Optional: auto-subscribe to GET /mcp/ SSE stream on connect() (recommended)
# MCP_AUTO_SUBSCRIBE=true

# Optional: override which tool ids are treated as streaming-sensitive
# MCP_STREAMING_TOOL_IDS=migration.migrate_all_dashboards,migration.migrate_all_datamodels


############################
# BACKEND (FASTAPI)
############################

# Where the FES backend API (backend/api_server.py) is running
FES_BACKEND_URL=http://localhost:8001

# LLM HTTP retry config (safe to retry)
LLM_HTTP_MAX_RETRIES=3
LLM_HTTP_RETRY_BASE_DELAY=0.5


############################
# FRONTEND (STREAMLIT UI)
############################

# Streamlit session idle timeout (hours) before we clear session_state
FES_UI_IDLE_TIMEOUT_HOURS=9


############################
# LOGGING
############################

# Global log level for UI + backend + MCP server
# Allowed: DEBUG, INFO, WARNING, ERROR, CRITICAL
FES_LOG_LEVEL=INFO

# Control pysisense SDK debug behaviour:
# Option A (recommended): tie SDK debug to FES_LOG_LEVEL
# (Leave PYSISENSE_SDK_DEBUG unset. Do not define it at all.)
#
# Option B: always enable verbose SDK debug
# PYSISENSE_SDK_DEBUG=true
#
# Option C: always disable SDK debug
# PYSISENSE_SDK_DEBUG=false


############################
# SUMMARIZATION / PRIVACY
############################

# Hard kill switch for sending tool results (Sisense data) to the LLM for summarization.
# false -> summarization completely disabled (UI cannot override)
# true  -> summarization allowed (subject to UI toggle)
ALLOW_SUMMARIZATION=true

# UI: whether the checkbox to allow summarization is visible/enabled
# true  -> user can toggle in the UI
# false -> checkbox is disabled (always off)
FES_ALLOW_SUMMARIZATION_TOGGLE=true


# ------------------------------------------------------------------------------
# MCP Server tool naming mode
# ------------------------------------------------------------------------------
# Claude Desktop rejects tool names that contain '.' during tools/list discovery.
# Set to "claude" to publish underscore tool names.
# The server will still ACCEPT both underscore and dotted names on tool calls.
MCP_TOOL_NAME_MODE=claude
# MCP_TOOL_NAME_MODE=canonical


# ------------------------------------------------------------------------------
# MCP Server concurrency caps (single-worker friendly)
# ------------------------------------------------------------------------------
# Limit how many long-running migrations can run at the same time.
PYSISENSE_MAX_CONCURRENT_MIGRATIONS=1

# Limit how many short/read tools can run concurrently while migrations are running.
PYSISENSE_MAX_CONCURRENT_READ_TOOLS=5


############################
# CLAUDE INTEGRATION (OPTIONAL DEFAULT TENANT FALLBACK)
############################

# Enable default tenant fallback ONLY when the caller doesn't provide domain/token in tool args
PYSISENSE_USE_DEFAULT_TENANT=false
PYSISENSE_DEFAULT_DOMAIN=
PYSISENSE_DEFAULT_TOKEN=
PYSISENSE_DEFAULT_SSL=false

# Enable default tenant fallback for migration tools ONLY when caller doesn't provide source/target creds
PYSISENSE_USE_DEFAULT_MIGRATION_TENANTS=false
PYSISENSE_DEFAULT_SOURCE_DOMAIN=
PYSISENSE_DEFAULT_SOURCE_TOKEN=
PYSISENSE_DEFAULT_SOURCE_SSL=true
PYSISENSE_DEFAULT_TARGET_DOMAIN=
PYSISENSE_DEFAULT_TARGET_TOKEN=
PYSISENSE_DEFAULT_TARGET_SSL=true